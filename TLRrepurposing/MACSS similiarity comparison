from os import listdir
from os.path import isfile
from os.path import join

from rdkit import Chem
from rdkit.Chem import AllChem
from rdkit import DataStructs
from e3fp.fingerprint.metrics import tanimoto, dice, cosine
from e3fp.fingerprint.fprint import Fingerprint, CountFingerprint
import numpy as np
from rdkit.Chem import MACCSkeys

import pandas as pd
#for histogram generation and manipulation
import seaborn
import matplotlib.mlab as mlab
import matplotlib.pyplot as plt

list=[]
name=[]

with open('/home/dsribar/Documents/tlr8/Repurposing/drugs.smi') as f:
    for line in f:
       list.append(line.split("\t")[0])
       name.append(line.split("\t")[1])
ms = [Chem.MolFromSmiles(x) for x in list]
fps = [MACCSkeys.GenMACCSKeys(x) for x in ms]

comparisonMatrix3D=[]
for i in range(0, len(list)):
    row = []
    fp1 = MACCSkeys.GenMACCSKeys(Chem.MolFromSmiles(list[i]))
    for j in range(0, len(list)):
        fp2 = MACCSkeys.GenMACCSKeys(Chem.MolFromSmiles(list[j]))
        row.append(round(DataStructs.FingerprintSimilarity(fp1,fp2), 2))
    comparisonMatrix3D.append(row)
comparisonMatrix3D = pd.DataFrame(comparisonMatrix3D)
comparisonMatrix3D.columns = name
comparisonMatrix3D.index = name

seaborn.heatmap(comparisonMatrix3D, cmap="Blues", annot=True)
plt.yticks(rotation=0)
plt.xticks(rotation=60)
plt.title("MACSS")
plt.show()